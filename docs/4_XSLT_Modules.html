<?xml version="1.0" encoding="UTF-8"?><html xmlns="http://www.w3.org/1999/xhtml" xmlns:xtlcon="http://www.xtpxlib.nl/ns/container" lang="en" xml:lang="en">
  
  
  
  
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
    <link rel="stylesheet" href="resources/bootstrap.min.css"/>
    <link rel="stylesheet" href="resources/xtpxlib-moduledoc.css"/>
    <link rel="shortcut icon" href="resources/favicon.ico"/>
    <title>4 XSLT Modules</title>
  </head>
  <body style="padding-top: 65px;"><nav class="navbar fixed-top navbar-expand-sm navbar-dark bg-dark"><a class="navbar-brand" href="index.html" title="home">xtpxlib-xoffice</a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"/></button><div id="navbarSupportedContent" class="collapse navbar-collapse"><ul class="navbar-nav mr-auto"><li class="nav-item dropdown"><a href="1_Description.html" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Description <span class="caret"/></a><div class="dropdown-menu"><a href="1_Description.html" class="dropdown-item">Description</a><div class="dropdown-divider"><!----></div><a class="dropdown-item" href="1_Description.html#d1319e138">Converting from Excel (.xlsx)</a><a class="dropdown-item" href="1_Description.html#d1319e186">Converting to Excel (.xlsx)</a><a class="dropdown-item" href="1_Description.html#d1319e288">Converting from Word (.docx)</a></div></li><li class="nav-item dropdown"><a href="2_XProc_Libraries.html" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">XProc Libraries <span class="caret"/></a><div class="dropdown-menu"><a href="2_XProc_Libraries.html" class="dropdown-item">XProc Libraries</a><div class="dropdown-divider"><!----></div><a class="dropdown-item" href="2_XProc_Libraries.html#excel.mod.xpl">XProc (1.0) library: excel.mod.xpl</a><a class="dropdown-item" href="2_XProc_Libraries.html#word.mod.xpl">XProc (1.0) library: word.mod.xpl</a></div></li><li class="nav-item dropdown"><a href="3_XML_Schemas.html" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">XML Schemas <span class="caret"/></a><div class="dropdown-menu"><a href="3_XML_Schemas.html" class="dropdown-item">XML Schemas</a><div class="dropdown-divider"><!----></div><a class="dropdown-item" href="3_XML_Schemas.html#xlsx-extract.xsd">XML Schema: xlsx-extract.xsd</a><a class="dropdown-item" href="3_XML_Schemas.html#xlsx-modify.xsd">XML Schema: xlsx-modify.xsd</a></div></li><li class="nav-item dropdown"><a href="4_XSLT_Modules.html" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">XSLT Modules <span class="caret"/></a><div class="dropdown-menu"><a href="4_XSLT_Modules.html" class="dropdown-item">XSLT Modules</a><div class="dropdown-divider"><!----></div><a class="dropdown-item" href="4_XSLT_Modules.html#excel-conversions.mod.xsl">XSLT (3.0): excel-conversions.mod.xsl</a><a class="dropdown-item" href="4_XSLT_Modules.html#xoffice.mod.xsl">XSLT (2.0): xoffice.mod.xsl</a></div></li><li class="nav-item"><a class="nav-link" href="resources/xtpxlib-xoffice-documentation.pdf" title="PDF version of this documentation site">PDF</a></li></ul></div></nav><div class="container"><a name="chapter-xslt-modules"><!----></a><div class="page-header" style="padding-top: 65px; margin-top: -65px;"><h1 class="chapter"><span class="chapter-number">4 </span>XSLT Modules</h1></div><p class="para">The xtpxlib-xoffice component contains the following XSLT modules.</p><div class="table"><table class="table table-sm table-bordered"><thead class="thead-light"><tr><th>Module</th><th>Description</th></tr></thead><tbody><tr><td><code class="code"><a href="#excel-conversions.mod.xsl"><span class="link">excel-conversions.mod.xsl</span></a></code></td><td>Excel data specific conversions</td></tr><tr><td><code class="code"><a href="#xoffice.mod.xsl"><span class="link">xoffice.mod.xsl</span></a></code></td><td>Library with support code for the MS Office file handling.</td></tr></tbody></table></div><div class="sect1" id="excel-conversions.mod.xsl"><a name="excel-conversions.mod.xsl"><!----></a><h2 class="sect1" style="padding-top: 65px; margin-top: -65px;"><span class="sect1-number">4.1</span> XSLT (3.0): <code class="code">excel-conversions.mod.xsl</code></h2><p class="para">File: <code class="code">xslmod/excel-conversions.mod.xsl</code></p><p class="para">Excel data specific conversions</p><div class="table"><table class="table table-sm table-bordered"><thead class="thead-light"><tr><th>Prefix</th><th>Namespace URI</th></tr></thead><tbody><tr><td><code class="code">xtlxo</code></td><td><code class="code">http://www.xtpxlib.nl/ns/xoffice</code></td></tr></tbody></table></div><div class="table"><table class="table table-sm table-bordered"><thead class="thead-light"><tr><th>Variable</th><th>Type</th><th>Value</th><th>Description</th></tr></thead><tbody><tr><td><code class="code">xtlxo:excel-start-date</code></td><td><code class="code">xs:date</code></td><td><code class="code">xs:date('1900-01-01')</code></td><td/></tr></tbody></table></div><div class="table"><table class="table table-sm table-bordered"><thead class="thead-light"><tr><th>Function</th><th>Description</th></tr></thead><tbody><tr><td><code class="code"><a href="#excel-conversions.mod.xsl-xtlxo_excel-date-to-xs-date-1"><span class="link">xtlxo:excel-date-to-xs-date()</span></a></code></td><td>Converts an Excel date integer into an xs:date.</td></tr><tr><td><code class="code"><a href="#excel-conversions.mod.xsl-xtlxo_xs-date-to-excel-date-1"><span class="link">xtlxo:xs-date-to-excel-date()</span></a></code></td><td>Converts an xs:date into an Excel date integer.</td></tr></tbody></table></div><div class="sect2" id="excel-conversions.mod.xsl-xtlxo_excel-date-to-xs-date-1"><a name="excel-conversions.mod.xsl-xtlxo_excel-date-to-xs-date-1"><!----></a><h3 class="sect2" style="padding-top: 65px; margin-top: -65px;"><span class="sect2-number">4.1.1</span> Function: <code class="code">xtlxo:excel-date-to-xs-date() as xs:date</code></h3><p class="para">Converts an Excel date integer into an xs:date.</p><div class="table"><table class="table table-sm table-bordered"><thead class="thead-light"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code class="code">excel-value</code></td><td><code class="code">xs:integer</code></td><td>The Excel date integer to convert.</td></tr></tbody></table></div></div><div class="sect2" id="excel-conversions.mod.xsl-xtlxo_xs-date-to-excel-date-1"><a name="excel-conversions.mod.xsl-xtlxo_xs-date-to-excel-date-1"><!----></a><h3 class="sect2" style="padding-top: 65px; margin-top: -65px;"><span class="sect2-number">4.1.2</span> Function: <code class="code">xtlxo:xs-date-to-excel-date() as xs:integer</code></h3><p class="para">Converts an xs:date into an Excel date integer.</p><div class="table"><table class="table table-sm table-bordered"><thead class="thead-light"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code class="code">date</code></td><td><code class="code">xs:date</code></td><td>The xs:date to convert.</td></tr></tbody></table></div></div></div><div class="sect1" id="xoffice.mod.xsl"><a name="xoffice.mod.xsl"><!----></a><h2 class="sect1" style="padding-top: 65px; margin-top: -65px;"><span class="sect1-number">4.2</span> XSLT (2.0): <code class="code">xoffice.mod.xsl</code></h2><p class="para">File: <code class="code">xslmod/xoffice.mod.xsl</code></p><p class="para">Library with support code for the MS Office file handling.</p><p class="para">Depends on the following XSLT modules from the xtpxlib-common component:</p><ul class="itemizedlist"><li><p class="para">general.mod.xsl</p></li><li><p class="para">href.mod.xsl</p></li></ul><p class="para">Yet largely undocumented. Use at your own risk.</p><div class="table"><table class="table table-sm table-bordered"><thead class="thead-light"><tr><th>Prefix</th><th>Namespace URI</th></tr></thead><tbody><tr><td><code class="code">xtlxo</code></td><td><code class="code">http://www.xtpxlib.nl/ns/xoffice</code></td></tr></tbody></table></div><div class="table"><table class="table table-sm table-bordered"><thead class="thead-light"><tr><th>Variable</th><th>Type</th><th>Value</th><th>Description</th></tr></thead><tbody><tr><td><code class="code">xtlxo:relationship-type-comments</code></td><td><code class="code">xs:string</code></td><td><code class="code">'http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments'</code></td><td/></tr><tr><td><code class="code">xtlxo:relationship-type-core-properties</code></td><td><code class="code">xs:string</code></td><td><code class="code">'http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties'</code></td><td/></tr><tr><td><code class="code">xtlxo:relationship-type-custom-properties</code></td><td><code class="code">xs:string</code></td><td><code class="code">'http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties'</code></td><td/></tr><tr><td><code class="code">xtlxo:relationship-type-extended-properties</code></td><td><code class="code">xs:string</code></td><td><code class="code">'http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties'</code></td><td/></tr><tr><td><code class="code">xtlxo:relationship-type-main-document</code></td><td><code class="code">xs:string</code></td><td><code class="code">'http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument'</code></td><td/></tr><tr><td><code class="code">xtlxo:relationship-type-shared-strings</code></td><td><code class="code">xs:string</code></td><td><code class="code">'http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings'</code></td><td/></tr></tbody></table></div><div class="table"><table class="table table-sm table-bordered"><thead class="thead-light"><tr><th>Named template</th><th>Description</th></tr></thead><tbody><tr><td><code class="code"><a href="#xoffice.mod.xsl-xtlxo_get-properties-1"><span class="link">xtlxo:get-properties</span></a></code></td><td/></tr></tbody></table></div><div class="table"><table class="table table-sm table-bordered"><thead class="thead-light"><tr><th>Function</th><th>Description</th></tr></thead><tbody><tr><td><code class="code"><a href="#xoffice.mod.xsl-xtlxo_doc-href-1"><span class="link">xtlxo:doc-href()</span></a></code></td><td/></tr><tr><td><code class="code"><a href="#xoffice.mod.xsl-xtlxo_get-file-root-3"><span class="link">xtlxo:get-file-root()</span></a></code></td><td/></tr><tr><td><code class="code"><a href="#xoffice.mod.xsl-xtlxo_get-file-root-from-relationship-id-4"><span class="link">xtlxo:get-file-root-from-relationship-id()</span></a></code></td><td/></tr><tr><td><code class="code"><a href="#xoffice.mod.xsl-xtlxo_get-file-root-from-relationship-type-4"><span class="link">xtlxo:get-file-root-from-relationship-type()</span></a></code></td><td/></tr><tr><td><code class="code"><a href="#xoffice.mod.xsl-xtlxo_get-file-root-relationship-3"><span class="link">xtlxo:get-file-root-relationship()</span></a></code></td><td/></tr><tr><td><code class="code"><a href="#xoffice.mod.xsl-xtlxo_get-href-1"><span class="link">xtlxo:get-href()</span></a></code></td><td/></tr><tr><td><code class="code"><a href="#xoffice.mod.xsl-xtlxo_get-rels-href-1"><span class="link">xtlxo:get-rels-href()</span></a></code></td><td/></tr></tbody></table></div><div class="sect2" id="xoffice.mod.xsl-xtlxo_get-properties-1"><a name="xoffice.mod.xsl-xtlxo_get-properties-1"><!----></a><h3 class="sect2" style="padding-top: 65px; margin-top: -65px;"><span class="sect2-number">4.2.1</span> Named template: <code class="code">xtlxo:get-properties</code></h3><div class="table"><table class="table table-sm table-bordered"><thead class="thead-light"><tr><th>Parameter</th><th>Type</th><th>Rq?</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code class="code">extracted-office-xml</code></td><td><code class="code">element(xtlcon:document-container)</code></td><td>Â </td><td><code class="code"/></td><td/></tr></tbody></table></div></div><div class="sect2" id="xoffice.mod.xsl-xtlxo_doc-href-1"><a name="xoffice.mod.xsl-xtlxo_doc-href-1"><!----></a><h3 class="sect2" style="padding-top: 65px; margin-top: -65px;"><span class="sect2-number">4.2.2</span> Function: <code class="code">xtlxo:doc-href() as xs:string</code></h3><div class="table"><table class="table table-sm table-bordered"><thead class="thead-light"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code class="code">href-parts</code></td><td><code class="code">xs:string+</code></td><td/></tr></tbody></table></div></div><div class="sect2" id="xoffice.mod.xsl-xtlxo_get-file-root-3"><a name="xoffice.mod.xsl-xtlxo_get-file-root-3"><!----></a><h3 class="sect2" style="padding-top: 65px; margin-top: -65px;"><span class="sect2-number">4.2.3</span> Function: <code class="code">xtlxo:get-file-root() as element()?</code></h3><div class="table"><table class="table table-sm table-bordered"><thead class="thead-light"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code class="code">extracted-office-xml</code></td><td><code class="code">element(xtlcon:document-container)</code></td><td/></tr><tr><td><code class="code">href-parts</code></td><td><code class="code">xs:string+</code></td><td/></tr><tr><td><code class="code">is-mandatory</code></td><td><code class="code">xs:boolean</code></td><td/></tr></tbody></table></div></div><div class="sect2" id="xoffice.mod.xsl-xtlxo_get-file-root-from-relationship-id-4"><a name="xoffice.mod.xsl-xtlxo_get-file-root-from-relationship-id-4"><!----></a><h3 class="sect2" style="padding-top: 65px; margin-top: -65px;"><span class="sect2-number">4.2.4</span> Function: <code class="code">xtlxo:get-file-root-from-relationship-id() as element()?</code></h3><div class="table"><table class="table table-sm table-bordered"><thead class="thead-light"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code class="code">extracted-office-xml</code></td><td><code class="code">element(xtlcon:document-container)</code></td><td/></tr><tr><td><code class="code">basefile-href</code></td><td><code class="code">xs:string</code></td><td/></tr><tr><td><code class="code">relationship-id</code></td><td><code class="code">xs:string</code></td><td/></tr><tr><td><code class="code">is-mandatory</code></td><td><code class="code">xs:boolean</code></td><td/></tr></tbody></table></div></div><div class="sect2" id="xoffice.mod.xsl-xtlxo_get-file-root-from-relationship-type-4"><a name="xoffice.mod.xsl-xtlxo_get-file-root-from-relationship-type-4"><!----></a><h3 class="sect2" style="padding-top: 65px; margin-top: -65px;"><span class="sect2-number">4.2.5</span> Function: <code class="code">xtlxo:get-file-root-from-relationship-type() as element()?</code></h3><div class="table"><table class="table table-sm table-bordered"><thead class="thead-light"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code class="code">extracted-office-xml</code></td><td><code class="code">element(xtlcon:document-container)</code></td><td/></tr><tr><td><code class="code">basefile-href</code></td><td><code class="code">xs:string</code></td><td/></tr><tr><td><code class="code">relationship-type</code></td><td><code class="code">xs:string</code></td><td/></tr><tr><td><code class="code">is-mandatory</code></td><td><code class="code">xs:boolean</code></td><td/></tr></tbody></table></div></div><div class="sect2" id="xoffice.mod.xsl-xtlxo_get-file-root-relationship-3"><a name="xoffice.mod.xsl-xtlxo_get-file-root-relationship-3"><!----></a><h3 class="sect2" style="padding-top: 65px; margin-top: -65px;"><span class="sect2-number">4.2.6</span> Function: <code class="code">xtlxo:get-file-root-relationship() as element(mso-rels:Relationships)?</code></h3><div class="table"><table class="table table-sm table-bordered"><thead class="thead-light"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code class="code">extracted-office-xml</code></td><td><code class="code">element(xtlcon:document-container)</code></td><td/></tr><tr><td><code class="code">basefile-href</code></td><td><code class="code">xs:string</code></td><td/></tr><tr><td><code class="code">is-mandatory</code></td><td><code class="code">xs:boolean</code></td><td/></tr></tbody></table></div></div><div class="sect2" id="xoffice.mod.xsl-xtlxo_get-href-1"><a name="xoffice.mod.xsl-xtlxo_get-href-1"><!----></a><h3 class="sect2" style="padding-top: 65px; margin-top: -65px;"><span class="sect2-number">4.2.7</span> Function: <code class="code">xtlxo:get-href() as xs:string</code></h3><div class="table"><table class="table table-sm table-bordered"><thead class="thead-light"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code class="code">elm</code></td><td><code class="code">element()</code></td><td/></tr></tbody></table></div></div><div class="sect2" id="xoffice.mod.xsl-xtlxo_get-rels-href-1"><a name="xoffice.mod.xsl-xtlxo_get-rels-href-1"><!----></a><h3 class="sect2" style="padding-top: 65px; margin-top: -65px;"><span class="sect2-number">4.2.8</span> Function: <code class="code">xtlxo:get-rels-href() as xs:string</code></h3><div class="table"><table class="table table-sm table-bordered"><thead class="thead-light"><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code class="code">basefile-href</code></td><td><code class="code">xs:string</code></td><td/></tr></tbody></table></div></div></div></div><script src="resources/jquery-3.4.1.slim.min.js"><!--  --></script><script src="resources/popper.min.js"><!--  --></script><script src="resources/bootstrap.min.js"><!--  --></script></body>
</html>