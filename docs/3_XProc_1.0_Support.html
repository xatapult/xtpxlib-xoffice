<?xml version="1.0" encoding="UTF-8"?>
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:xtlcon="http://www.xtpxlib.nl/ns/container">
  
  
  
  
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
    <link rel="stylesheet" href="resources/bootstrap.min.css"/>
    <link rel="stylesheet" href="resources/xtpxlib-moduledoc.css"/>
    <link rel="shortcut icon" href="resources/favicon.ico"/>
    <title>3 XProc 1.0 Support</title>
  </head>
  <body style="padding-top: 65px;"><nav class="navbar fixed-top navbar-expand-sm navbar-dark bg-dark"><a class="navbar-brand" href="index.html" title="home">xtpxlib-xoffice</a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"/></button><div id="navbarSupportedContent" class="collapse navbar-collapse"><ul class="navbar-nav mr-auto"><li class="nav-item dropdown"><a href="1_Description.html" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Description <span class="caret"/></a><div class="dropdown-menu"><a href="1_Description.html" class="dropdown-item">Description</a><div class="dropdown-divider"><!----></div><a class="dropdown-item" href="1_Description.html#d2016e213">Converting from Excel (.xlsx)</a><a class="dropdown-item" href="1_Description.html#d2016e263">Converting to Excel (.xlsx)</a><a class="dropdown-item" href="1_Description.html#d2016e377">Converting from Word (.docx)</a></div></li><li class="nav-item dropdown"><a href="2_XProc_3.0_Support.html" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">XProc 3.0 Support <span class="caret"/></a><div class="dropdown-menu"><a href="2_XProc_3.0_Support.html" class="dropdown-item">XProc 3.0 Support</a><div class="dropdown-divider"><!----></div><a class="dropdown-item" href="2_XProc_3.0_Support.html#xpl3-create-docx.xpl">XProc (3.0) pipeline: create-docx.xpl</a><a class="dropdown-item" href="2_XProc_3.0_Support.html#xpl3-docx-to-xml.xpl">XProc (3.0) pipeline: docx-to-xml.xpl</a><a class="dropdown-item" href="2_XProc_3.0_Support.html#xpl3-modify-xlsx.xpl">XProc (3.0) pipeline: modify-xlsx.xpl</a><a class="dropdown-item" href="2_XProc_3.0_Support.html#xpl3-xlsx-to-xml.xpl">XProc (3.0) pipeline: xlsx-to-xml.xpl</a></div></li><li class="nav-item dropdown"><a href="3_XProc_1.0_Support.html" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">XProc 1.0 Support <span class="caret"/></a><div class="dropdown-menu"><a href="3_XProc_1.0_Support.html" class="dropdown-item">XProc 1.0 Support</a><div class="dropdown-divider"><!----></div><a class="dropdown-item" href="3_XProc_1.0_Support.html#common.mod.xpl">XProc (1.0) library: common.mod.xpl</a></div></li><li class="nav-item dropdown"><a href="4_XML_Schemas.html" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">XML Schemas <span class="caret"/></a><div class="dropdown-menu"><a href="4_XML_Schemas.html" class="dropdown-item">XML Schemas</a><div class="dropdown-divider"><!----></div><a class="dropdown-item" href="4_XML_Schemas.html#xlsx-extract.xsd">XML Schema: xlsx-extract.xsd</a><a class="dropdown-item" href="4_XML_Schemas.html#xlsx-modify.xsd">XML Schema: xlsx-modify.xsd</a></div></li><li class="nav-item dropdown"><a href="5_XSLT_Modules.html" class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">XSLT Modules <span class="caret"/></a><div class="dropdown-menu"><a href="5_XSLT_Modules.html" class="dropdown-item">XSLT Modules</a><div class="dropdown-divider"><!----></div><a class="dropdown-item" href="5_XSLT_Modules.html#excel-conversions.mod.xsl">XSLT (3.0): excel-conversions.mod.xsl</a><a class="dropdown-item" href="5_XSLT_Modules.html#xoffice.mod.xsl">XSLT (3.0): xoffice.mod.xsl</a></div></li><li class="nav-item"><a class="nav-link" href="resources/xtpxlib-xoffice-documentation.pdf" title="PDF version of this documentation site">PDF</a></li></ul></div></nav><div class="container"><a name="chapter-xproc-1-libraries"><!----></a><div class="page-header" style="padding-top: 65px; margin-top: -65px;"><h1 class="chapter"><span class="chapter-number">3 </span>XProc 1.0 Support</h1></div><p class="para" id="d2016e986"><a name="d2016e986"><!----></a>The xtpxlib-xoffice component contains the following XProc 1.0 library modules:</p><p class="para" id="d2016e989"><a name="d2016e989"><!----></a><b>WARNING</b>: XProcÂ 1.0 support is considered deprecated and will be removed in the near future!</p><div class="table" id="d2016e994"><a name="d2016e994"><!----></a><table class="table table-sm table-bordered"><thead id="d2016e1000" class="thead-light"><tr id="d2016e1001"><th id="d2016e1002"><a name="d2016e1002"><!----></a>Module/Pipeline</th><th id="d2016e1004"><a name="d2016e1004"><!----></a>Description</th></tr></thead><tbody id="d2016e1006"><tr id="d2016e1007"><td id="d2016e1008"><a name="d2016e1008"><!----></a><a name="d2016e1009"><!----></a><code class="code code-width-limited"><a href="#common.mod.xpl"><span class="link">common.mod.xpl</span></a></code></td><td id="d2016e1013"><a name="d2016e1013"><!----></a><a name="d2016e1014"><!----></a>XProc (1.0) library with generic steps.</td></tr></tbody></table></div><div class="sect1" id="common.mod.xpl"><a name="common.mod.xpl"><!----></a><h2 class="sect1" style="padding-top: 65px; margin-top: -65px;"><span class="sect1-number">3.1</span> XProc (1.0) library: <code class="code">common.mod.xpl</code></h2><p class="para keep-with-next" id="d2016e1021"><a name="d2016e1021"><!----></a>File: <code class="code">xplmod/common.mod/common.mod.xpl</code></p><p class="para" id="d2016e1025"><a name="d2016e1025"><!----></a>XProc (1.0) library with generic steps.</p><div class="table nonumber" id="d2016e1027"><a name="d2016e1027"><!----></a><table class="table table-sm table-bordered"><thead id="d2016e1032" class="thead-light"><tr id="d2016e1033"><th id="d2016e1034"><a name="d2016e1034"><!----></a>Prefix</th><th id="d2016e1036"><a name="d2016e1036"><!----></a>Namespace URI</th></tr></thead><tbody id="d2016e1038"><tr id="d2016e1039"><td id="d2016e1040"><a name="d2016e1040"><!----></a><a name="d2016e1041"><!----></a><code class="code code-width-limited">xtlc</code></td><td id="d2016e1044"><a name="d2016e1044"><!----></a><a name="d2016e1045"><!----></a><code class="code">http://www.xtpxlib.nl/ns/common</code></td></tr></tbody></table></div><div class="table nonumber" id="d2016e1048"><a name="d2016e1048"><!----></a><table class="table table-sm table-bordered"><thead id="d2016e1053" class="thead-light"><tr id="d2016e1054"><th id="d2016e1055"><a name="d2016e1055"><!----></a>Step</th><th id="d2016e1057"><a name="d2016e1057"><!----></a>Description</th></tr></thead><tbody id="d2016e1059"><tr id="d2016e1060"><td id="d2016e1061"><a name="d2016e1061"><!----></a><a name="d2016e1062"><!----></a><code class="code code-width-limited"><a href="#common.mod.xpl-xtlc_copy-directory"><span class="link">xtlc:copy-directory</span></a></code></td><td id="d2016e1066"><a name="d2016e1066"><!----></a><a name="d2016e1067"><!----></a>Copies a full directory structure.</td></tr><tr id="d2016e1069"><td id="d2016e1070"><a name="d2016e1070"><!----></a><a name="d2016e1071"><!----></a><code class="code code-width-limited"><a href="#common.mod.xpl-xtlc_copy-file"><span class="link">xtlc:copy-file</span></a></code></td><td id="d2016e1075"><a name="d2016e1075"><!----></a><a name="d2016e1076"><!----></a>Copies a file, if necessary from inside a zip file.</td></tr><tr id="d2016e1078"><td id="d2016e1079"><a name="d2016e1079"><!----></a><a name="d2016e1080"><!----></a><code class="code code-width-limited"><a href="#common.mod.xpl-xtlc_log"><span class="link">xtlc:log</span></a></code></td><td id="d2016e1084"><a name="d2016e1084"><!----></a><a name="d2016e1085"><!----></a>Writes a message to a log file.</td></tr><tr id="d2016e1087"><td id="d2016e1088"><a name="d2016e1088"><!----></a><a name="d2016e1089"><!----></a><code class="code code-width-limited"><a href="#common.mod.xpl-xtlc_recursive-directory-list"><span class="link">xtlc:recursive-directory-list</span></a></code></td><td id="d2016e1093"><a name="d2016e1093"><!----></a><a name="d2016e1094"><!----></a>Returns the contents of a directory, going into sub-directories recursively. When the requested directory does not exist, it returns only a <code class="code">c:directory</code> root element with an <code class="code">error="true"</code> attribute.</td></tr><tr id="d2016e1102"><td id="d2016e1103"><a name="d2016e1103"><!----></a><a name="d2016e1104"><!----></a><code class="code code-width-limited"><a href="#common.mod.xpl-xtlc_remove-dir"><span class="link">xtlc:remove-dir</span></a></code></td><td id="d2016e1108"><a name="d2016e1108"><!----></a><a name="d2016e1109"><!----></a>Removes a full directory When the directory does not exist, everything continues without error.</td></tr><tr id="d2016e1111"><td id="d2016e1112"><a name="d2016e1112"><!----></a><a name="d2016e1113"><!----></a><code class="code code-width-limited"><a href="#common.mod.xpl-xtlc_tee"><span class="link">xtlc:tee</span></a></code></td><td id="d2016e1117"><a name="d2016e1117"><!----></a><a name="d2016e1118"><!----></a>Tees the input to a file and passes it unchanged (like the Unix tee command).</td></tr><tr id="d2016e1120"><td id="d2016e1121"><a name="d2016e1121"><!----></a><a name="d2016e1122"><!----></a><code class="code code-width-limited"><a href="#common.mod.xpl-xtlc_zip-directory"><span class="link">xtlc:zip-directory</span></a></code></td><td id="d2016e1126"><a name="d2016e1126"><!----></a><a name="d2016e1127"><!----></a>Zips a directory and its sub-directories into a single zip file.</td></tr></tbody></table></div><div class="sect2" id="common.mod.xpl-xtlc_copy-directory"><a name="common.mod.xpl-xtlc_copy-directory"><!----></a><h3 class="sect2" style="padding-top: 65px; margin-top: -65px;"><span class="sect2-number">3.1.1</span> Step: <code class="code">xtlc:copy-directory</code></h3><p class="para" id="d2016e1134"><a name="d2016e1134"><!----></a>Copies a full directory structure.</p><div class="table nonumber" id="d2016e1136"><a name="d2016e1136"><!----></a><table class="table table-sm table-bordered"><thead id="d2016e1143" class="thead-light"><tr id="d2016e1144"><th id="d2016e1145"><a name="d2016e1145"><!----></a>Port</th><th id="d2016e1147"><a name="d2016e1147"><!----></a>Type</th><th id="d2016e1149"><a name="d2016e1149"><!----></a>Primary?</th><th id="d2016e1151"><a name="d2016e1151"><!----></a>Description</th></tr></thead><tbody id="d2016e1153"><tr id="d2016e1154"><td id="d2016e1155"><a name="d2016e1155"><!----></a><a name="d2016e1156"><!----></a><code class="code code-width-limited">source</code></td><td id="d2016e1159"><a name="d2016e1159"><!----></a>in</td><td id="d2016e1161"><a name="d2016e1161"><!----></a>yes</td><td id="d2016e1163"><a name="d2016e1163"><!----></a><a name="d2016e1164"><!----></a>Input, will be passed unchanged.</td></tr><tr id="d2016e1166"><td id="d2016e1167"><a name="d2016e1167"><!----></a><a name="d2016e1168"><!----></a><code class="code code-width-limited">result</code></td><td id="d2016e1171"><a name="d2016e1171"><!----></a>out</td><td id="d2016e1173"><a name="d2016e1173"><!----></a>yes</td><td id="d2016e1175"><a name="d2016e1175"><!----></a><a name="d2016e1176"><!----></a>The input unchanged.</td></tr></tbody></table></div><div class="table nonumber" id="d2016e1178"><a name="d2016e1178"><!----></a><table class="table table-sm table-bordered"><thead id="d2016e1185" class="thead-light"><tr id="d2016e1186"><th id="d2016e1187"><a name="d2016e1187"><!----></a>Option</th><th id="d2016e1189"><a name="d2016e1189"><!----></a>Rq?</th><th id="d2016e1191"><a name="d2016e1191"><!----></a>Default</th><th id="d2016e1193"><a name="d2016e1193"><!----></a>Description</th></tr></thead><tbody id="d2016e1195"><tr id="d2016e1196"><td id="d2016e1197"><a name="d2016e1197"><!----></a><a name="d2016e1198"><!----></a><code class="code code-width-limited">href-source-dir</code></td><td id="d2016e1201"><a name="d2016e1201"><!----></a><a name="d2016e1202"><!----></a>yes</td><td id="d2016e1204"><a name="d2016e1204"><!----></a><a name="d2016e1205"><!----></a><code class="code code-width-limited"/></td><td id="d2016e1207"><a name="d2016e1207"><!----></a><a name="d2016e1208"><!----></a>Reference to the directory to copy from (must have a leading <code class="code">file:/</code> specifier!).</td></tr><tr id="d2016e1213"><td id="d2016e1214"><a name="d2016e1214"><!----></a><a name="d2016e1215"><!----></a><code class="code code-width-limited">href-target-dir</code></td><td id="d2016e1218"><a name="d2016e1218"><!----></a><a name="d2016e1219"><!----></a>yes</td><td id="d2016e1221"><a name="d2016e1221"><!----></a><a name="d2016e1222"><!----></a><code class="code code-width-limited"/></td><td id="d2016e1224"><a name="d2016e1224"><!----></a><a name="d2016e1225"><!----></a>Reference to the directory to copy to (must have a leading <code class="code">file:/</code> specifier!). If it does not exist the step will try to create it.</td></tr></tbody></table></div></div><div class="sect2" id="common.mod.xpl-xtlc_copy-file"><a name="common.mod.xpl-xtlc_copy-file"><!----></a><h3 class="sect2" style="padding-top: 65px; margin-top: -65px;"><span class="sect2-number">3.1.2</span> Step: <code class="code">xtlc:copy-file</code></h3><p class="para" id="d2016e1235"><a name="d2016e1235"><!----></a>Copies a file, if necessary from inside a zip file.</p><div class="table nonumber" id="d2016e1237"><a name="d2016e1237"><!----></a><table class="table table-sm table-bordered"><thead id="d2016e1244" class="thead-light"><tr id="d2016e1245"><th id="d2016e1246"><a name="d2016e1246"><!----></a>Port</th><th id="d2016e1248"><a name="d2016e1248"><!----></a>Type</th><th id="d2016e1250"><a name="d2016e1250"><!----></a>Primary?</th><th id="d2016e1252"><a name="d2016e1252"><!----></a>Description</th></tr></thead><tbody id="d2016e1254"><tr id="d2016e1255"><td id="d2016e1256"><a name="d2016e1256"><!----></a><a name="d2016e1257"><!----></a><code class="code code-width-limited">source</code></td><td id="d2016e1260"><a name="d2016e1260"><!----></a>in</td><td id="d2016e1262"><a name="d2016e1262"><!----></a>yes</td><td id="d2016e1264"><a name="d2016e1264"><!----></a><a name="d2016e1265"><!----></a>Input, will be passed unchanged.</td></tr><tr id="d2016e1267"><td id="d2016e1268"><a name="d2016e1268"><!----></a><a name="d2016e1269"><!----></a><code class="code code-width-limited">result</code></td><td id="d2016e1272"><a name="d2016e1272"><!----></a>out</td><td id="d2016e1274"><a name="d2016e1274"><!----></a>yes</td><td id="d2016e1276"><a name="d2016e1276"><!----></a><a name="d2016e1277"><!----></a>The input unchanged.</td></tr></tbody></table></div><div class="table nonumber" id="d2016e1279"><a name="d2016e1279"><!----></a><table class="table table-sm table-bordered"><thead id="d2016e1286" class="thead-light"><tr id="d2016e1287"><th id="d2016e1288"><a name="d2016e1288"><!----></a>Option</th><th id="d2016e1290"><a name="d2016e1290"><!----></a>Rq?</th><th id="d2016e1292"><a name="d2016e1292"><!----></a>Default</th><th id="d2016e1294"><a name="d2016e1294"><!----></a>Description</th></tr></thead><tbody id="d2016e1296"><tr id="d2016e1297"><td id="d2016e1298"><a name="d2016e1298"><!----></a><a name="d2016e1299"><!----></a><code class="code code-width-limited">enable</code></td><td id="d2016e1302"><a name="d2016e1302"><!----></a><a name="d2016e1303"><!----></a>Â </td><td id="d2016e1305"><a name="d2016e1305"><!----></a><a name="d2016e1306"><!----></a><code class="code code-width-limited">true()</code></td><td id="d2016e1309"><a name="d2016e1309"><!----></a><a name="d2016e1310"><!----></a>Whether the copying is done at all.</td></tr><tr id="d2016e1312"><td id="d2016e1313"><a name="d2016e1313"><!----></a><a name="d2016e1314"><!----></a><code class="code code-width-limited">href-source</code></td><td id="d2016e1317"><a name="d2016e1317"><!----></a><a name="d2016e1318"><!----></a>yes</td><td id="d2016e1320"><a name="d2016e1320"><!----></a><a name="d2016e1321"><!----></a><code class="code code-width-limited"/></td><td id="d2016e1323"><a name="d2016e1323"><!----></a><a name="d2016e1324"><!----></a>Reference to the source file to copy (must have a leading <code class="code">file:/</code> specifier!).</td></tr><tr id="d2016e1329"><td id="d2016e1330"><a name="d2016e1330"><!----></a><a name="d2016e1331"><!----></a><code class="code code-width-limited">href-source-zip</code></td><td id="d2016e1334"><a name="d2016e1334"><!----></a><a name="d2016e1335"><!----></a>Â </td><td id="d2016e1337"><a name="d2016e1337"><!----></a><a name="d2016e1338"><!----></a><code class="code code-width-limited">''</code></td><td id="d2016e1341"><a name="d2016e1341"><!----></a><a name="d2016e1342"><!----></a>Document reference to a zip file (must have a leading <code class="code">file:/</code> specifier!). When filled, <code class="code">$href-source</code> is assumed to be a path inside this zip.</td></tr><tr id="d2016e1350"><td id="d2016e1351"><a name="d2016e1351"><!----></a><a name="d2016e1352"><!----></a><code class="code code-width-limited">href-target</code></td><td id="d2016e1355"><a name="d2016e1355"><!----></a><a name="d2016e1356"><!----></a>yes</td><td id="d2016e1358"><a name="d2016e1358"><!----></a><a name="d2016e1359"><!----></a><code class="code code-width-limited"/></td><td id="d2016e1361"><a name="d2016e1361"><!----></a><a name="d2016e1362"><!----></a>Reference to the target.</td></tr></tbody></table></div></div><div class="sect2" id="common.mod.xpl-xtlc_log"><a name="common.mod.xpl-xtlc_log"><!----></a><h3 class="sect2" style="padding-top: 65px; margin-top: -65px;"><span class="sect2-number">3.1.3</span> Step: <code class="code">xtlc:log</code></h3><p class="para" id="d2016e1369"><a name="d2016e1369"><!----></a>Writes a message to a log file.</p><div class="table nonumber" id="d2016e1371"><a name="d2016e1371"><!----></a><table class="table table-sm table-bordered"><thead id="d2016e1378" class="thead-light"><tr id="d2016e1379"><th id="d2016e1380"><a name="d2016e1380"><!----></a>Port</th><th id="d2016e1382"><a name="d2016e1382"><!----></a>Type</th><th id="d2016e1384"><a name="d2016e1384"><!----></a>Primary?</th><th id="d2016e1386"><a name="d2016e1386"><!----></a>Description</th></tr></thead><tbody id="d2016e1388"><tr id="d2016e1389"><td id="d2016e1390"><a name="d2016e1390"><!----></a><a name="d2016e1391"><!----></a><code class="code code-width-limited">source</code></td><td id="d2016e1394"><a name="d2016e1394"><!----></a>in</td><td id="d2016e1396"><a name="d2016e1396"><!----></a>yes</td><td id="d2016e1398"><a name="d2016e1398"><!----></a><a name="d2016e1399"><!----></a>Input to the logging, will be passed unchanged to the output</td></tr><tr id="d2016e1401"><td id="d2016e1402"><a name="d2016e1402"><!----></a><a name="d2016e1403"><!----></a><code class="code code-width-limited">result</code></td><td id="d2016e1406"><a name="d2016e1406"><!----></a>out</td><td id="d2016e1408"><a name="d2016e1408"><!----></a>yes</td><td id="d2016e1410"><a name="d2016e1410"><!----></a><a name="d2016e1411"><!----></a>The input unchanged.</td></tr></tbody></table></div><div class="table nonumber" id="d2016e1413"><a name="d2016e1413"><!----></a><table class="table table-sm table-bordered"><thead id="d2016e1420" class="thead-light"><tr id="d2016e1421"><th id="d2016e1422"><a name="d2016e1422"><!----></a>Option</th><th id="d2016e1424"><a name="d2016e1424"><!----></a>Rq?</th><th id="d2016e1426"><a name="d2016e1426"><!----></a>Default</th><th id="d2016e1428"><a name="d2016e1428"><!----></a>Description</th></tr></thead><tbody id="d2016e1430"><tr id="d2016e1431"><td id="d2016e1432"><a name="d2016e1432"><!----></a><a name="d2016e1433"><!----></a><code class="code code-width-limited">enable</code></td><td id="d2016e1436"><a name="d2016e1436"><!----></a><a name="d2016e1437"><!----></a>Â </td><td id="d2016e1439"><a name="d2016e1439"><!----></a><a name="d2016e1440"><!----></a><code class="code code-width-limited">true()</code></td><td id="d2016e1443"><a name="d2016e1443"><!----></a><a name="d2016e1444"><!----></a>Whether the logging will be done at all.</td></tr><tr id="d2016e1446"><td id="d2016e1447"><a name="d2016e1447"><!----></a><a name="d2016e1448"><!----></a><code class="code code-width-limited">href-log</code></td><td id="d2016e1451"><a name="d2016e1451"><!----></a><a name="d2016e1452"><!----></a>yes</td><td id="d2016e1454"><a name="d2016e1454"><!----></a><a name="d2016e1455"><!----></a><code class="code code-width-limited"/></td><td id="d2016e1457"><a name="d2016e1457"><!----></a><a name="d2016e1458"><!----></a>Name of the file to write the log messages to (must have a leading <code class="code">file:/</code> specifier!).</td></tr><tr id="d2016e1463"><td id="d2016e1464"><a name="d2016e1464"><!----></a><a name="d2016e1465"><!----></a><code class="code code-width-limited">keep-messages</code></td><td id="d2016e1468"><a name="d2016e1468"><!----></a><a name="d2016e1469"><!----></a>Â </td><td id="d2016e1471"><a name="d2016e1471"><!----></a><a name="d2016e1472"><!----></a><code class="code code-width-limited">100</code></td><td id="d2016e1475"><a name="d2016e1475"><!----></a><a name="d2016e1476"><!----></a>The number of messages to keep in the logfile. If le <code class="code">0</code>, all messages are kept. Set by default to <code class="code">100</code> to prevent overflowing filesâ¦</td></tr><tr id="d2016e1484"><td id="d2016e1485"><a name="d2016e1485"><!----></a><a name="d2016e1486"><!----></a><code class="code code-width-limited">message</code></td><td id="d2016e1489"><a name="d2016e1489"><!----></a><a name="d2016e1490"><!----></a>yes</td><td id="d2016e1492"><a name="d2016e1492"><!----></a><a name="d2016e1493"><!----></a><code class="code code-width-limited"/></td><td id="d2016e1495"><a name="d2016e1495"><!----></a><a name="d2016e1496"><!----></a>The actual log message to write.</td></tr><tr id="d2016e1498"><td id="d2016e1499"><a name="d2016e1499"><!----></a><a name="d2016e1500"><!----></a><code class="code code-width-limited">status</code></td><td id="d2016e1503"><a name="d2016e1503"><!----></a><a name="d2016e1504"><!----></a>Â </td><td id="d2016e1506"><a name="d2016e1506"><!----></a><a name="d2016e1507"><!----></a><code class="code code-width-limited">'ok'</code></td><td id="d2016e1510"><a name="d2016e1510"><!----></a><a name="d2016e1511"><!----></a>Status of the message. Must be <code class="code">ok</code>, <code class="code">warning</code>, <code class="code">error</code> or <code class="code">debug</code>.</td></tr></tbody></table></div></div><div class="sect2" id="common.mod.xpl-xtlc_recursive-directory-list"><a name="common.mod.xpl-xtlc_recursive-directory-list"><!----></a><h3 class="sect2" style="padding-top: 65px; margin-top: -65px;"><span class="sect2-number">3.1.4</span> Step: <code class="code">xtlc:recursive-directory-list</code></h3><p class="para" id="d2016e1530"><a name="d2016e1530"><!----></a>Returns the contents of a directory, going into sub-directories recursively. When the requested directory does not exist, it returns only a <code class="code">c:directory</code> root element with an <code class="code">error="true"</code> attribute.</p><p class="para" id="d2016e1538"><a name="d2016e1538"><!----></a>Adapted from Norman Walsh's <a href="https://github.com/xquery/xquerydoc/blob/master/deps/xmlcalabash/recursive-directory-list.xpl"><span class="link">example code</span></a>.</p><div class="table nonumber" id="d2016e1543"><a name="d2016e1543"><!----></a><table class="table table-sm table-bordered"><thead id="d2016e1550" class="thead-light"><tr id="d2016e1551"><th id="d2016e1552"><a name="d2016e1552"><!----></a>Port</th><th id="d2016e1554"><a name="d2016e1554"><!----></a>Type</th><th id="d2016e1556"><a name="d2016e1556"><!----></a>Primary?</th><th id="d2016e1558"><a name="d2016e1558"><!----></a>Description</th></tr></thead><tbody id="d2016e1560"><tr id="d2016e1561"><td id="d2016e1562"><a name="d2016e1562"><!----></a><a name="d2016e1563"><!----></a><code class="code code-width-limited">result</code></td><td id="d2016e1566"><a name="d2016e1566"><!----></a>out</td><td id="d2016e1568"><a name="d2016e1568"><!----></a>yes</td><td id="d2016e1570"><a name="d2016e1570"><!----></a><a name="d2016e1571"><!----></a>The resulting directory structure listing in XML format.</td></tr></tbody></table></div><div class="table nonumber" id="d2016e1573"><a name="d2016e1573"><!----></a><table class="table table-sm table-bordered"><thead id="d2016e1580" class="thead-light"><tr id="d2016e1581"><th id="d2016e1582"><a name="d2016e1582"><!----></a>Option</th><th id="d2016e1584"><a name="d2016e1584"><!----></a>Rq?</th><th id="d2016e1586"><a name="d2016e1586"><!----></a>Default</th><th id="d2016e1588"><a name="d2016e1588"><!----></a>Description</th></tr></thead><tbody id="d2016e1590"><tr id="d2016e1591"><td id="d2016e1592"><a name="d2016e1592"><!----></a><a name="d2016e1593"><!----></a><code class="code code-width-limited">depth</code></td><td id="d2016e1596"><a name="d2016e1596"><!----></a><a name="d2016e1597"><!----></a>Â </td><td id="d2016e1599"><a name="d2016e1599"><!----></a><a name="d2016e1600"><!----></a><code class="code code-width-limited">-1</code></td><td id="d2016e1603"><a name="d2016e1603"><!----></a><a name="d2016e1604"><!----></a>The sub-directory depth to go. When le <code class="code">0</code>, all sub-directories are processed.</td></tr><tr id="d2016e1609"><td id="d2016e1610"><a name="d2016e1610"><!----></a><a name="d2016e1611"><!----></a><code class="code code-width-limited">exclude-filter</code></td><td id="d2016e1614"><a name="d2016e1614"><!----></a><a name="d2016e1615"><!----></a>Â </td><td id="d2016e1617"><a name="d2016e1617"><!----></a><a name="d2016e1618"><!----></a><code class="code code-width-limited"/></td><td id="d2016e1620"><a name="d2016e1620"><!----></a><a name="d2016e1621"><!----></a>An optional regular expression exclude filter.</td></tr><tr id="d2016e1623"><td id="d2016e1624"><a name="d2016e1624"><!----></a><a name="d2016e1625"><!----></a><code class="code code-width-limited">flatten</code></td><td id="d2016e1628"><a name="d2016e1628"><!----></a><a name="d2016e1629"><!----></a>Â </td><td id="d2016e1631"><a name="d2016e1631"><!----></a><a name="d2016e1632"><!----></a><code class="code code-width-limited">false()</code></td><td id="d2016e1635"><a name="d2016e1635"><!----></a><a name="d2016e1636"><!----></a>When <code class="code">true</code>, the list will be "flattened": All <code class="code">c:file</code> children will be direct children of the root's <code class="code">c:directory</code> element. These <code class="code">c:file</code> elements get a <code class="code">@name</code>, <code class="code">@href-abs</code> (absolute filename) and <code class="code">@href-rel</code> (relative filename) attribute.</td></tr><tr id="d2016e1660"><td id="d2016e1661"><a name="d2016e1661"><!----></a><a name="d2016e1662"><!----></a><code class="code code-width-limited">include-filter</code></td><td id="d2016e1665"><a name="d2016e1665"><!----></a><a name="d2016e1666"><!----></a>Â </td><td id="d2016e1668"><a name="d2016e1668"><!----></a><a name="d2016e1669"><!----></a><code class="code code-width-limited"/></td><td id="d2016e1671"><a name="d2016e1671"><!----></a><a name="d2016e1672"><!----></a>An optional regular expression include filter.</td></tr><tr id="d2016e1674"><td id="d2016e1675"><a name="d2016e1675"><!----></a><a name="d2016e1676"><!----></a><code class="code code-width-limited">path</code></td><td id="d2016e1679"><a name="d2016e1679"><!----></a><a name="d2016e1680"><!----></a>yes</td><td id="d2016e1682"><a name="d2016e1682"><!----></a><a name="d2016e1683"><!----></a><code class="code code-width-limited"/></td><td id="d2016e1685"><a name="d2016e1685"><!----></a><a name="d2016e1686"><!----></a>The path to get the directory listing from.</td></tr></tbody></table></div></div><div class="sect2" id="common.mod.xpl-xtlc_remove-dir"><a name="common.mod.xpl-xtlc_remove-dir"><!----></a><h3 class="sect2" style="padding-top: 65px; margin-top: -65px;"><span class="sect2-number">3.1.5</span> Step: <code class="code">xtlc:remove-dir</code></h3><p class="para" id="d2016e1693"><a name="d2016e1693"><!----></a>Removes a full directory When the directory does not exist, everything continues without error.</p><div class="table nonumber" id="d2016e1695"><a name="d2016e1695"><!----></a><table class="table table-sm table-bordered"><thead id="d2016e1702" class="thead-light"><tr id="d2016e1703"><th id="d2016e1704"><a name="d2016e1704"><!----></a>Port</th><th id="d2016e1706"><a name="d2016e1706"><!----></a>Type</th><th id="d2016e1708"><a name="d2016e1708"><!----></a>Primary?</th><th id="d2016e1710"><a name="d2016e1710"><!----></a>Description</th></tr></thead><tbody id="d2016e1712"><tr id="d2016e1713"><td id="d2016e1714"><a name="d2016e1714"><!----></a><a name="d2016e1715"><!----></a><code class="code code-width-limited">source</code></td><td id="d2016e1718"><a name="d2016e1718"><!----></a>in</td><td id="d2016e1720"><a name="d2016e1720"><!----></a>yes</td><td id="d2016e1722"><a name="d2016e1722"><!----></a><a name="d2016e1723"><!----></a>Input, will be passed unchanged.</td></tr><tr id="d2016e1725"><td id="d2016e1726"><a name="d2016e1726"><!----></a><a name="d2016e1727"><!----></a><code class="code code-width-limited">result</code></td><td id="d2016e1730"><a name="d2016e1730"><!----></a>out</td><td id="d2016e1732"><a name="d2016e1732"><!----></a>yes</td><td id="d2016e1734"><a name="d2016e1734"><!----></a><a name="d2016e1735"><!----></a>The input unchanged.</td></tr></tbody></table></div><div class="table nonumber" id="d2016e1737"><a name="d2016e1737"><!----></a><table class="table table-sm table-bordered"><thead id="d2016e1744" class="thead-light"><tr id="d2016e1745"><th id="d2016e1746"><a name="d2016e1746"><!----></a>Option</th><th id="d2016e1748"><a name="d2016e1748"><!----></a>Rq?</th><th id="d2016e1750"><a name="d2016e1750"><!----></a>Default</th><th id="d2016e1752"><a name="d2016e1752"><!----></a>Description</th></tr></thead><tbody id="d2016e1754"><tr id="d2016e1755"><td id="d2016e1756"><a name="d2016e1756"><!----></a><a name="d2016e1757"><!----></a><code class="code code-width-limited">enable</code></td><td id="d2016e1760"><a name="d2016e1760"><!----></a><a name="d2016e1761"><!----></a>Â </td><td id="d2016e1763"><a name="d2016e1763"><!----></a><a name="d2016e1764"><!----></a><code class="code code-width-limited">true()</code></td><td id="d2016e1767"><a name="d2016e1767"><!----></a><a name="d2016e1768"><!----></a>Whether the removal is done at all.</td></tr><tr id="d2016e1770"><td id="d2016e1771"><a name="d2016e1771"><!----></a><a name="d2016e1772"><!----></a><code class="code code-width-limited">href-dir</code></td><td id="d2016e1775"><a name="d2016e1775"><!----></a><a name="d2016e1776"><!----></a>yes</td><td id="d2016e1778"><a name="d2016e1778"><!----></a><a name="d2016e1779"><!----></a><code class="code code-width-limited"/></td><td id="d2016e1781"><a name="d2016e1781"><!----></a><a name="d2016e1782"><!----></a>Reference to the directory to remove (must have a leading <code class="code">file:/</code> specifier!).</td></tr></tbody></table></div></div><div class="sect2" id="common.mod.xpl-xtlc_tee"><a name="common.mod.xpl-xtlc_tee"><!----></a><h3 class="sect2" style="padding-top: 65px; margin-top: -65px;"><span class="sect2-number">3.1.6</span> Step: <code class="code">xtlc:tee</code></h3><p class="para" id="d2016e1792"><a name="d2016e1792"><!----></a>Tees the input to a file and passes it unchanged (like the Unix tee command).</p><div class="table nonumber" id="d2016e1794"><a name="d2016e1794"><!----></a><table class="table table-sm table-bordered"><thead id="d2016e1801" class="thead-light"><tr id="d2016e1802"><th id="d2016e1803"><a name="d2016e1803"><!----></a>Port</th><th id="d2016e1805"><a name="d2016e1805"><!----></a>Type</th><th id="d2016e1807"><a name="d2016e1807"><!----></a>Primary?</th><th id="d2016e1809"><a name="d2016e1809"><!----></a>Description</th></tr></thead><tbody id="d2016e1811"><tr id="d2016e1812"><td id="d2016e1813"><a name="d2016e1813"><!----></a><a name="d2016e1814"><!----></a><code class="code code-width-limited">source</code></td><td id="d2016e1817"><a name="d2016e1817"><!----></a>in</td><td id="d2016e1819"><a name="d2016e1819"><!----></a>yes</td><td id="d2016e1821"><a name="d2016e1821"><!----></a><a name="d2016e1822"><!----></a>Input to the tee.</td></tr><tr id="d2016e1824"><td id="d2016e1825"><a name="d2016e1825"><!----></a><a name="d2016e1826"><!----></a><code class="code code-width-limited">result</code></td><td id="d2016e1829"><a name="d2016e1829"><!----></a>out</td><td id="d2016e1831"><a name="d2016e1831"><!----></a>yes</td><td id="d2016e1833"><a name="d2016e1833"><!----></a><a name="d2016e1834"><!----></a>The input unchanged (unless a <code class="code">$root-attribute-href</code> was specified).</td></tr></tbody></table></div><div class="table nonumber" id="d2016e1839"><a name="d2016e1839"><!----></a><table class="table table-sm table-bordered"><thead id="d2016e1846" class="thead-light"><tr id="d2016e1847"><th id="d2016e1848"><a name="d2016e1848"><!----></a>Option</th><th id="d2016e1850"><a name="d2016e1850"><!----></a>Rq?</th><th id="d2016e1852"><a name="d2016e1852"><!----></a>Default</th><th id="d2016e1854"><a name="d2016e1854"><!----></a>Description</th></tr></thead><tbody id="d2016e1856"><tr id="d2016e1857"><td id="d2016e1858"><a name="d2016e1858"><!----></a><a name="d2016e1859"><!----></a><code class="code code-width-limited">enable</code></td><td id="d2016e1862"><a name="d2016e1862"><!----></a><a name="d2016e1863"><!----></a>Â </td><td id="d2016e1865"><a name="d2016e1865"><!----></a><a name="d2016e1866"><!----></a><code class="code code-width-limited">true()</code></td><td id="d2016e1869"><a name="d2016e1869"><!----></a><a name="d2016e1870"><!----></a>Whether to actually do the write. When <code class="code">false</code>, nothing happens.</td></tr><tr id="d2016e1875"><td id="d2016e1876"><a name="d2016e1876"><!----></a><a name="d2016e1877"><!----></a><code class="code code-width-limited">href</code></td><td id="d2016e1880"><a name="d2016e1880"><!----></a><a name="d2016e1881"><!----></a>yes</td><td id="d2016e1883"><a name="d2016e1883"><!----></a><a name="d2016e1884"><!----></a><code class="code code-width-limited"/></td><td id="d2016e1886"><a name="d2016e1886"><!----></a><a name="d2016e1887"><!----></a>Name of the file to write to (must have a leading <code class="code">file:/</code> specifier!)</td></tr><tr id="d2016e1892"><td id="d2016e1893"><a name="d2016e1893"><!----></a><a name="d2016e1894"><!----></a><code class="code code-width-limited">indent</code></td><td id="d2016e1897"><a name="d2016e1897"><!----></a><a name="d2016e1898"><!----></a>Â </td><td id="d2016e1900"><a name="d2016e1900"><!----></a><a name="d2016e1901"><!----></a><code class="code code-width-limited">true()</code></td><td id="d2016e1904"><a name="d2016e1904"><!----></a><a name="d2016e1905"><!----></a>Whether or not to indent the tee-d output.</td></tr><tr id="d2016e1907"><td id="d2016e1908"><a name="d2016e1908"><!----></a><a name="d2016e1909"><!----></a><code class="code code-width-limited">root-attribute-href</code></td><td id="d2016e1912"><a name="d2016e1912"><!----></a><a name="d2016e1913"><!----></a>Â </td><td id="d2016e1915"><a name="d2016e1915"><!----></a><a name="d2016e1916"><!----></a><code class="code code-width-limited">''</code></td><td id="d2016e1919"><a name="d2016e1919"><!----></a><a name="d2016e1920"><!----></a>If filled, <code class="code">$href</code> is recorded as an attribute with this name on the root element of the original input. Must be a valid attribute name.</td></tr></tbody></table></div></div><div class="sect2" id="common.mod.xpl-xtlc_zip-directory"><a name="common.mod.xpl-xtlc_zip-directory"><!----></a><h3 class="sect2" style="padding-top: 65px; margin-top: -65px;"><span class="sect2-number">3.1.7</span> Step: <code class="code">xtlc:zip-directory</code></h3><p class="para" id="d2016e1931"><a name="d2016e1931"><!----></a>Zips a directory and its sub-directories into a single zip file.</p><div class="table nonumber" id="d2016e1933"><a name="d2016e1933"><!----></a><table class="table table-sm table-bordered"><thead id="d2016e1940" class="thead-light"><tr id="d2016e1941"><th id="d2016e1942"><a name="d2016e1942"><!----></a>Port</th><th id="d2016e1944"><a name="d2016e1944"><!----></a>Type</th><th id="d2016e1946"><a name="d2016e1946"><!----></a>Primary?</th><th id="d2016e1948"><a name="d2016e1948"><!----></a>Description</th></tr></thead><tbody id="d2016e1950"><tr id="d2016e1951"><td id="d2016e1952"><a name="d2016e1952"><!----></a><a name="d2016e1953"><!----></a><code class="code code-width-limited">result</code></td><td id="d2016e1956"><a name="d2016e1956"><!----></a>out</td><td id="d2016e1958"><a name="d2016e1958"><!----></a>yes</td><td id="d2016e1960"><a name="d2016e1960"><!----></a><a name="d2016e1961"><!----></a>The output of the actual zip step, listing all the files that went in.</td></tr></tbody></table></div><div class="table nonumber" id="d2016e1963"><a name="d2016e1963"><!----></a><table class="table table-sm table-bordered"><thead id="d2016e1970" class="thead-light"><tr id="d2016e1971"><th id="d2016e1972"><a name="d2016e1972"><!----></a>Option</th><th id="d2016e1974"><a name="d2016e1974"><!----></a>Rq?</th><th id="d2016e1976"><a name="d2016e1976"><!----></a>Default</th><th id="d2016e1978"><a name="d2016e1978"><!----></a>Description</th></tr></thead><tbody id="d2016e1980"><tr id="d2016e1981"><td id="d2016e1982"><a name="d2016e1982"><!----></a><a name="d2016e1983"><!----></a><code class="code code-width-limited">base-path</code></td><td id="d2016e1986"><a name="d2016e1986"><!----></a><a name="d2016e1987"><!----></a>yes</td><td id="d2016e1989"><a name="d2016e1989"><!----></a><a name="d2016e1990"><!----></a><code class="code code-width-limited"/></td><td id="d2016e1992"><a name="d2016e1992"><!----></a><a name="d2016e1993"><!----></a>Directory which contents will be stored in the zip (must have a leading <code class="code">file:/</code> specifier!)</td></tr><tr id="d2016e1998"><td id="d2016e1999"><a name="d2016e1999"><!----></a><a name="d2016e2000"><!----></a><code class="code code-width-limited">href-target-zip</code></td><td id="d2016e2003"><a name="d2016e2003"><!----></a><a name="d2016e2004"><!----></a>yes</td><td id="d2016e2006"><a name="d2016e2006"><!----></a><a name="d2016e2007"><!----></a><code class="code code-width-limited"/></td><td id="d2016e2009"><a name="d2016e2009"><!----></a><a name="d2016e2010"><!----></a>Document reference for the zip file to produce (must have a leading <code class="code">file:/</code> specifier!)</td></tr><tr id="d2016e2015"><td id="d2016e2016"><a name="d2016e2016"><!----></a><a name="d2016e2017"><!----></a><code class="code code-width-limited">include-base</code></td><td id="d2016e2020"><a name="d2016e2020"><!----></a><a name="d2016e2021"><!----></a>Â </td><td id="d2016e2023"><a name="d2016e2023"><!----></a><a name="d2016e2024"><!----></a><code class="code code-width-limited">true()</code></td><td id="d2016e2027"><a name="d2016e2027"><!----></a><a name="d2016e2028"><!----></a>When true, the last part of <code class="code">$base-path</code> (e.g. <code class="code">a/b/c</code> ==&gt; <code class="code">c</code>) is used as the root directory in the zip file.</td></tr></tbody></table></div></div></div></div><script src="resources/jquery-3.4.1.slim.min.js"><!--  --></script><script src="resources/popper.min.js"><!--  --></script><script src="resources/bootstrap.min.js"><!--  --></script></body>
</html>